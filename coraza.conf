# -- Coraza WAF Configuration --
# Based on coraza.conf-recommended with blocking enabled

# Enable the rule engine (On = blocking mode)
SecRuleEngine On

# -- Request body handling --
SecRequestBodyAccess On
SecRequestBodyLimit 13107200
SecRequestBodyNoFilesLimit 131072
SecRequestBodyLimitAction Reject

# -- Response body handling --
SecResponseBodyAccess On
SecResponseBodyMimeType text/plain text/html text/xml application/json
SecResponseBodyLimit 524288
SecResponseBodyLimitAction ProcessPartial

# -- Filesystem configuration --
SecTmpDir /tmp/
SecDataDir /tmp/

# -- Audit logging --
SecAuditEngine RelevantOnly
SecAuditLogRelevantStatus "^(?:5\d\d|40[0-35-9]|4[1-9]\d)"
SecAuditLogParts ABIJDEFHZ
SecAuditLogType Serial
SecAuditLog /var/log/coraza/audit.log

# -- Miscellaneous --
SecArgumentSeparator &
SecCookieFormat 0

# -- Debug log (disabled by default) --
# SecDebugLog /var/log/coraza/debug.log
# SecDebugLogLevel 3

# -- OWASP CRS v4 --
Include /etc/coraza/crs/crs-setup.conf.example
Include /etc/coraza/crs/rules/*.conf
